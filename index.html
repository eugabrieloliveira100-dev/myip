<!DOCTYPE html>
<html lang="en-US" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Check My IP Today - IP Lookup & Whois Tool</title>
    
    <link rel="preconnect" href="https://api.ipify.org">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CPDBZNF3CT"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-CPDBZNF3CT');
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: { 'primary-dark': '#0f172a', 'secondary-dark': '#1e293b', 'accent': '#3b82f6' },
                    fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['Fira Code', 'monospace'] },
                }
            }
        }
    </script>

    <style>
        :root { font-display: swap; }
        body { transition: background-color 0.3s, color 0.3s; }
        
        .skeleton { background: linear-gradient(90deg, #e2e8f0 25%, #cbd5e1 50%, #e2e8f0 75%); background-size: 200% 100%; animation: loading 1.5s infinite; }
        .dark .skeleton { background: linear-gradient(90deg, #1e293b 25%, #334155 50%, #1e293b 75%); background-size: 200% 100%; }
        
        @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        
        .terminal-box { font-family: 'Fira Code', monospace; border-radius: 12px; transition: all 0.3s; }
        .terminal-light { background-color: #f8fafc; color: #334155; border: 1px solid #e2e8f0; }
        .dark .terminal-dark-box { background-color: #0d1117; color: #e6edf3; border: 1px solid #30363d; }

        /* CORRE√á√ÉO DO SELETOR DE IDIOMAS NO HOVER */
        #lang-selector option {
            background-color: white !important;
            color: #1e293b !important;
        }
        .dark #lang-selector option {
            background-color: #1e293b !important;
            color: #f1f5f9 !important;
        }
        #lang-selector:focus { outline: none; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5); }
    </style>
</head>
<body class="bg-white text-slate-900 dark:bg-primary-dark dark:text-gray-100 min-h-screen flex flex-col">

    <header class="w-full max-w-6xl mx-auto px-6 py-8 flex justify-between items-center">
        <h1 class="text-2xl font-extrabold tracking-tight">Check My IP <span class="text-accent italic">Today</span></h1>
        <div class="flex items-center gap-4">
            <select id="lang-selector" class="bg-gray-100 dark:bg-secondary-dark border border-gray-300 dark:border-gray-700 rounded-lg px-3 py-1.5 text-xs font-bold text-slate-700 dark:text-gray-200 cursor-pointer transition-colors">
                <option value="en">English</option>
                <option value="pt">Portugu√™s</option>
            </select>
            <button id="theme-toggle" class="p-2.5 rounded-lg bg-gray-100 dark:bg-secondary-dark hover:ring-2 ring-accent transition-all text-slate-700 dark:text-gray-200">
                <svg id="theme-icon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"></svg>
            </button>
        </div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-6 max-w-4xl space-y-8">
        
        <!-- SE√á√ÉO WHOIS AVAN√áADA -->
        <section class="space-y-4">
            <div class="flex flex-col gap-1">
                <h3 id="label-whois-title" class="text-xl font-bold px-1 flex items-center gap-2 text-slate-800 dark:text-white">
                    <span class="text-accent">üîç</span> Network & Organization Details
                </h3>
                <p id="label-whois-desc" class="text-sm text-slate-500 dark:text-gray-400 px-1">Lookup any IP address for detailed ASN, ISP and WHOIS records.</p>
            </div>
            
            <div class="flex flex-col md:flex-row gap-3">
                <div class="relative flex-grow">
                    <input id="whois-input" type="text" placeholder="Enter IP for deep lookup..." 
                        class="w-full bg-gray-50 dark:bg-secondary-dark border border-gray-200 dark:border-gray-700 rounded-2xl px-6 py-4 text-lg outline-none focus:ring-4 ring-accent/20 transition-all shadow-md text-slate-900 dark:text-white font-mono">
                </div>
                <button id="whois-btn" class="bg-accent hover:bg-blue-600 text-white font-bold px-8 py-4 rounded-2xl shadow-lg transition-all transform active:scale-95">
                    Lookup
                </button>
            </div>
            
            <div id="whois-terminal" class="terminal-box terminal-light dark:terminal-dark-box p-6 text-[11px] md:text-xs leading-relaxed overflow-x-auto min-h-[100px] hidden shadow-inner border">
            </div>
        </section>

        <!-- CARD DE IP PRINCIPAL -->
        <div class="bg-white dark:bg-secondary-dark rounded-3xl shadow-2xl border border-gray-200 dark:border-gray-800 overflow-hidden">
            <div class="p-8 md:p-12 text-center border-b border-gray-100 dark:border-gray-800 bg-gradient-to-b from-transparent to-gray-50 dark:to-primary-dark/5">
                <h2 id="label-your-ip" class="text-sm font-bold text-slate-400 dark:text-gray-500 uppercase tracking-widest mb-6">Your Public IP Address</h2>
                <div id="ipv4-display" class="text-5xl md:text-8xl font-black tracking-tighter text-accent break-all">
                     <div class="h-20 w-64 mx-auto skeleton rounded-2xl"></div>
                </div>
                <p class="text-[10px] font-bold text-slate-400 dark:text-gray-500 mt-2 uppercase tracking-widest">IPv4 Protocol</p>
                
                <div class="mt-8 pt-6 border-t border-gray-100 dark:border-gray-800/50 max-w-sm mx-auto">
                    <div id="ipv6-display" class="text-xs md:text-base font-mono text-slate-600 dark:text-gray-400 break-all font-bold">
                        <div class="h-5 w-56 mx-auto skeleton rounded mt-2"></div>
                    </div>
                    <p class="text-[9px] font-bold text-slate-400 dark:text-gray-500 mt-1 uppercase tracking-widest">IPv6 Protocol</p>
                </div>
            </div>

            <!-- GRID DE INFORMA√á√ïES -->
            <div class="p-8 grid grid-cols-1 md:grid-cols-2 gap-8 bg-gray-50/50 dark:bg-primary-dark/20">
                <div id="geo-details" class="space-y-4">
                    <h3 id="label-loc-info" class="font-bold flex items-center gap-2 text-sm uppercase text-slate-400 dark:text-gray-500"><span class="w-1.5 h-4 bg-accent rounded-full"></span> Location Info</h3>
                    <div id="geo-grid" class="grid grid-cols-2 gap-3">
                        <div class="h-12 skeleton rounded-xl"></div><div class="h-12 skeleton rounded-xl"></div>
                        <div class="h-12 skeleton rounded-xl"></div><div class="h-12 skeleton rounded-xl"></div>
                    </div>
                </div>
                <div id="network-details" class="space-y-4">
                    <h3 id="label-prov-info" class="font-bold flex items-center gap-2 text-sm uppercase text-slate-400 dark:text-gray-500"><span class="w-1.5 h-4 bg-blue-400 rounded-full"></span> Provider Info</h3>
                    <div id="net-grid" class="space-y-3">
                        <div class="h-28 skeleton rounded-xl"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- GUIDE TERMINAL -->
        <div class="bg-gray-50 dark:bg-secondary-dark rounded-3xl p-8 space-y-6 border border-gray-100 dark:border-none">
            <h3 id="label-terminal-title" class="text-lg font-bold flex items-center gap-2 text-slate-800 dark:text-white">üíª Check IP via Terminal</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="space-y-2">
                    <p class="text-[10px] font-bold text-slate-400 dark:text-gray-500 uppercase tracking-widest px-1">Linux / macOS / Unix</p>
                    <div class="terminal-box terminal-light dark:terminal-dark-box p-4 text-xs flex justify-between items-center group">
                        <code class="font-bold">curl ifconfig.me</code>
                        <button onclick="copyToClipboard('curl ifconfig.me')" class="text-accent font-black px-2 hover:scale-110 transition-transform">Copy</button>
                    </div>
                </div>
                <div class="space-y-2">
                    <p class="text-[10px] font-bold text-slate-400 dark:text-gray-500 uppercase tracking-widest px-1">Windows (PowerShell)</p>
                    <div class="terminal-box terminal-light dark:terminal-dark-box p-4 text-xs flex justify-between items-center group">
                        <code class="font-bold">curl.exe ifconfig.me</code>
                        <button onclick="copyToClipboard('curl.exe ifconfig.me')" class="text-accent font-black px-2 hover:scale-110 transition-transform">Copy</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

  <!-- Substitua o seu <footer> atual por este no index.html -->
<footer class="py-12 text-center text-slate-400 dark:text-gray-500 text-[10px] md:text-xs border-t border-gray-200 dark:border-gray-800 mt-12 bg-gray-50/50 dark:bg-white/5">
    <div class="flex justify-center gap-6 mb-4 font-bold uppercase tracking-widest">
        <a href="glossary.html" id="footer-glossary" class="hover:text-accent transition-colors">Network Glossary</a>
        <span class="opacity-30">|</span>
        <a href="ipv6-location.html" id="footer-location" class="hover:text-accent transition-colors">Why New York?</a>
    </div>
    <p class="font-bold mb-1 italic">CheckMyIP.Today</p>
    <p>&copy; 2024 Professional Network Diagnostics.</p>
</footer>

<!-- No seu <script> de tradu√ß√£o no index.html, adicione estas linhas: -->
<script>
// No objeto de tradu√ß√µes (translations), adicione:
// en: {
//    ...
//    "footer-glossary": "Network Glossary",
//    "footer-location": "Why New York?"
// },
// pt: {
//    ...
//    "footer-glossary": "Gloss√°rio de Rede",
//    "footer-location": "Por que S√£o Paulo?"
// }

// E dentro da sua fun√ß√£o updateLanguage(), certifique-se de que estes IDs s√£o atualizados:
// document.getElementById('footer-glossary').innerText = translations[currentLang]['footer-glossary'];
// document.getElementById('footer-location').innerText = translations[currentLang]['footer-location'];
</script>

    <script>
        const translations = {
            en: {
                yourIp: "Your Public IP Address",
                whoisTitle: "Network & Organization Details",
                whoisDesc: "Lookup any IP address for detailed ASN, ISP and WHOIS records.",
                locInfo: "Location Info",
                provInfo: "Provider Info",
                terminalTitle: "Check IP via Terminal",
                lookup: "Lookup",
                loading: "Querying global records...",
                country: "Country", city: "City", isp: "Provider", timezone: "Timezone", asn: "ASN",
                netInfo: "Network Information", orgInfo: "Organization / Entity", regStatus: "Registration Status", contactInfo: "Contact Information"
            },
            pt: {
                yourIp: "Seu Endere√ßo IP P√∫blico",
                whoisTitle: "Detalhes de Rede e Organiza√ß√£o",
                whoisDesc: "Consulte qualquer endere√ßo IP para obter registros detalhados de ASN, ISP e WHOIS.",
                locInfo: "Informa√ß√µes de Localiza√ß√£o",
                provInfo: "Informa√ß√µes do Provedor",
                terminalTitle: "Verificar IP via Terminal",
                lookup: "Consultar",
                loading: "Consultando registros globais...",
                country: "Pa√≠s", city: "Cidade", isp: "Provedor", timezone: "Fuso Hor√°rio", asn: "N√∫mero ASN",
                netInfo: "Informa√ß√µes de Rede", orgInfo: "Organiza√ß√£o / Entidade", regStatus: "Status do Registro", contactInfo: "Informa√ß√µes de Contato"
            }
        };

        let currentLang = 'en';
        let lastGeoData = null;

        function updateLanguage() {
            const t = translations[currentLang];
            document.getElementById('label-your-ip').innerText = t.yourIp;
            document.getElementById('label-whois-title').innerHTML = `<span class="text-accent">üîç</span> ${t.whoisTitle}`;
            document.getElementById('label-whois-desc').innerText = t.whoisDesc;
            document.getElementById('label-terminal-title').innerText = `üíª ${t.terminalTitle}`;
            document.getElementById('label-loc-info').innerHTML = `<span class="w-1.5 h-4 bg-accent rounded-full"></span> ${t.locInfo}`;
            document.getElementById('label-prov-info').innerHTML = `<span class="w-1.5 h-4 bg-blue-400 rounded-full"></span> ${t.provInfo}`;
            document.getElementById('whois-btn').innerText = t.lookup;
            document.getElementById('whois-input').placeholder = currentLang === 'pt' ? "Digite o IP para busca profunda..." : "Enter IP for deep lookup...";
            if (lastGeoData) renderGeoGrid(lastGeoData);
        }

        async function fetchMainData() {
            const ipv4Disp = document.getElementById('ipv4-display');
            const ipv6Disp = document.getElementById('ipv6-display');

            try {
                const [v4res, v6res] = await Promise.allSettled([
                    fetch('https://api.ipify.org?format=json').then(r => r.json()),
                    fetch('https://api64.ipify.org?format=json').then(r => r.json())
                ]);

                const v4 = v4res.status === 'fulfilled' ? v4res.value.ip : 'Not Detected';
                const v6 = v6res.status === 'fulfilled' ? v6res.value.ip : 'Not Detected';

                ipv4Disp.innerHTML = v4 !== 'Not Detected' ? `<span class="text-accent">${v4}</span>` : `<span class="text-slate-300 dark:text-gray-700 text-3xl">N/A</span>`;
                ipv6Disp.innerText = v6;

                const mainIp = v4 !== 'Not Detected' ? v4 : v6;
                if (mainIp !== 'Not Detected') {
                    loadGeo(mainIp);
                }
            } catch (e) { ipv4Disp.innerText = "Error"; }
        }

        async function loadGeo(ip) {
            try {
                const res = await fetch(`https://ipapi.co/${ip}/json/`);
                lastGeoData = await res.json();
                renderGeoGrid(lastGeoData);
                fetchWhois(ip);
            } catch (e) { console.error(e); }
        }

        function renderGeoGrid(d) {
            const t = translations[currentLang];
            document.getElementById('geo-grid').innerHTML = `
                <div class="bg-white dark:bg-secondary-dark p-4 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-sm">
                    <p class="text-[9px] text-slate-400 dark:text-gray-500 font-bold uppercase tracking-widest mb-1">${t.country}</p>
                    <p class="font-bold text-sm truncate text-slate-800 dark:text-gray-200">${d.country_name || 'N/A'}</p>
                </div>
                <div class="bg-white dark:bg-secondary-dark p-4 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-sm">
                    <p class="text-[9px] text-slate-400 dark:text-gray-500 font-bold uppercase tracking-widest mb-1">${t.city}</p>
                    <p class="font-bold text-sm truncate text-slate-800 dark:text-gray-200">${d.city || 'N/A'}</p>
                </div>
                <div class="bg-white dark:bg-secondary-dark p-4 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-sm">
                    <p class="text-[9px] text-slate-400 dark:text-gray-500 font-bold uppercase tracking-widest mb-1">${t.timezone}</p>
                    <p class="font-bold text-[10px] truncate text-slate-800 dark:text-gray-200">${d.timezone || 'N/A'}</p>
                </div>
                <div class="bg-white dark:bg-secondary-dark p-4 rounded-2xl border border-gray-100 dark:border-gray-800 shadow-sm">
                    <p class="text-[9px] text-slate-400 dark:text-gray-500 font-bold uppercase tracking-widest mb-1">LAT/LONG</p>
                    <p class="font-bold text-[10px] text-slate-800 dark:text-gray-200">${d.latitude}, ${d.longitude}</p>
                </div>
            `;

            document.getElementById('net-grid').innerHTML = `
                <div class="bg-white dark:bg-secondary-dark p-5 rounded-2xl border border-gray-100 dark:border-gray-800 h-full flex flex-col justify-center shadow-sm">
                    <div>
                        <p class="text-[9px] text-slate-400 dark:text-gray-500 font-bold uppercase tracking-widest mb-1">${t.isp}</p>
                        <p class="font-bold text-base text-accent leading-tight">${d.org || 'N/A'}</p>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-100 dark:border-gray-800">
                        <p class="text-[9px] text-slate-400 dark:text-gray-500 font-bold uppercase tracking-widest mb-1">${t.asn}</p>
                        <p class="font-mono text-xs font-bold text-slate-700 dark:text-gray-300">${d.asn || 'N/A'}</p>
                    </div>
                </div>
            `;
        }

        async function fetchWhois(ip) {
            const term = document.getElementById('whois-terminal');
            const t = translations[currentLang];
            term.classList.remove('hidden');
            term.innerHTML = `<div class="flex items-center gap-2"><div class="h-2 w-2 bg-accent rounded-full animate-ping"></div> ${t.loading}</div>`;
            
            try {
                // RDAP provides more structured data than legacy Whois
                const res = await fetch(`https://rdap.db.ripe.net/ip/${ip}`);
                const data = await res.json();
                
                // Extracting structured sections
                const network = `${data.startAddress} - ${data.endAddress}`;
                const handle = data.handle || 'N/A';
                const status = data.status ? data.status.join(', ').toUpperCase() : 'N/A';
                const org = data.name || 'N/A';
                
                // Entities (Contacts)
                const entities = data.entities ? data.entities.map(e => `[${e.roles?.join('/') || 'ENTITY'}] ${e.handle}`).join('\n') : 'No contacts listed';

                const output = `
[ ${t.netInfo.toUpperCase()} ]
-----------------------------------------------------------
RANGE:    ${network}
HANDLE:   ${handle}
VERSION:  IP${data.ipVersion || 'v4'}
PARENT:   ${data.parentHandle || 'ROOT'}

[ ${t.orgInfo.toUpperCase()} ]
-----------------------------------------------------------
ENTITY:   ${org}
NAME:     ${data.type || 'ALLOCATED'}
COUNTRY:  ${data.country || 'N/A'}

[ ${t.regStatus.toUpperCase()} ]
-----------------------------------------------------------
STATUS:   ${status}
SOURCE:   ${data.port43 || 'RDAP SERVICE'}

[ ${t.contactInfo.toUpperCase()} ]
-----------------------------------------------------------
${entities}

-----------------------------------------------------------
>> QUERY COMPLETED FOR: ${ip}`;

                term.innerHTML = `<pre class="whitespace-pre-wrap">${output}</pre>`;
            } catch (e) {
                term.innerHTML = `<div class="text-red-500 font-bold">Error: Unable to fetch deep whois records for ${ip}. The IP might be private or the database is unreachable.</div>`;
            }
        }

        function copyToClipboard(text) {
            const el = document.createElement('textarea');
            el.value = text;
            document.body.appendChild(el);
            el.select();
            document.execCommand('copy');
            document.body.removeChild(el);
        }

        function updateThemeIcon() {
            const isDark = document.documentElement.classList.contains('dark');
            const icon = document.getElementById('theme-icon');
            icon.innerHTML = isDark ? 
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707M16.242 16.242l.707.707M7.758 7.758l.707.707M12 5a7 7 0 100 14 7 7 0 000-14z"></path>' : 
                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>';
        }

        document.getElementById('lang-selector').onchange = (e) => {
            currentLang = e.target.value;
            updateLanguage();
        };

        document.getElementById('whois-btn').onclick = () => {
            const val = document.getElementById('whois-input').value.trim();
            if(val) fetchWhois(val);
        };

        document.getElementById('theme-toggle').onclick = () => {
            document.documentElement.classList.toggle('dark');
            updateThemeIcon();
        };

        window.onload = () => {
            updateLanguage();
            fetchMainData();
            updateThemeIcon();
        };
    </script>
</body>
</html>
